{% extends 'partials/_master.twig' %}

{% set meta_title = record.meta_title ? record.meta_title : record.title %}
{% set meta_description = record.meta_description %}
{% set meta_keywords = record.meta_keywords %}

{% block main %}
    <section class="section main">
        <div class="container">

            <nav class="breadcrumb" aria-label="breadcrumbs">
                <ul>
                    <li><a href="{{ path('homepage') }}">Главная</a></li>
                    {#<li><a href="#">Documentation</a></li>#}
                    {#<li><a href="#">Components</a></li>#}
                    <li class="is-active"><a href="#" aria-current="page">{{ record.title }}</a></li>
                </ul>
            </nav>

            <h1 class="title is-1">{{ record.title }}</h1>

            {%  if record.subtitle %}
                <h2 class="subtitle is-5">{{ record.subtitle }}
                    {% if record.taxonomy.cities is defined %}
                        {% set city_key = record.taxonomy.cities | keys | first | split('/') | last %}
                        {% set city_name =  app.config.get('taxonomy/cities/options/' ~ city_key) %}
                        {%  if city_name %}
                            <br /><span class="float-right"><a href="{{ path('city', { 'name' : city_key }) }}">{{ city_name }}</a></span>
                        {% endif %}
                    {% endif %}
                </h2>
            {% endif %}

            <div class="columns">
                <div class="column is-3">
                    {%  if place.image %}
                        <img width="100%" class="" src="{{ place.image | thumbnail(480, 300, 'c') }}" alt=""/>
                        {% if record.price_from or record.price_to %}
                            <p><strong>Цена:</strong> {% if record.price_from %} от {{ record.price_from  }}{% endif %}{% if record.price_to %} от {{ record.price_to }}{% endif %}</p>
                        {% endif %}

                        {% if record.phone %}
                            <p><strong>Телефон</strong>: {{ record.phone }}</p>
                        {% endif %}

                        {% if record.address %}
                            <p><strong>Адрес:</strong> {{ record.address }}</p>
                        {% endif %}

                        {% if record.url %}
                            <p><strong>Ссылка на сайт:</strong> <a href="{{ record.url }}">{{ record.url }}</a></p>
                        {% endif %}

                    {% endif %}
                </div>
                <div class="column is-9">

                    {% if record.gallery | length > 0 %}
                        <div class="place-slider">
                        {#<div >#}
                            {% for image in record.gallery %}
                                <img width="100%" class="" src="{{ image | thumbnail(1380, 1380, 'r') }}" alt=""/>
                            {% endfor %}
                        </div>
                    {% endif %}

                </div>
            </div>

            {% if record.tour_url %}
                <br />
                <iframe width="100%"  height="580px" src="{{ record.tour_url }}" ></iframe>
                <br />
            {% endif %}

            {% if record.body %}
                <br />
                <div class="">
                    {{ record.body }}
                </div>
                <br />
            {% endif %}

            {% if record.flamp_widget_id %}
                <a class="flamp-widget" href="//novosibirsk.flamp.ru/firm/pravilno_sidi_optovo_roznichnaya_kompaniya_po_prodazhe_rastushhejj_mebeli_part_i_stulev-{{ record.flamp_widget_id  }}"  data-flamp-widget-type="responsive-new" data-flamp-widget-id="{{ record.flamp_widget_id  }}" data-flamp-widget-width="100%" data-flamp-widget-count="10">Отзывы о нас на Флампе</a><script>!function(d,s){var js,fjs=d.getElementsByTagName(s)[0];js=d.createElement(s);js.async=1;js.src="//widget.flamp.ru/loader.js";fjs.parentNode.insertBefore(js,fjs);}(document,"script");</script>
            {% endif %}

        </div>
    </section>

    {% setcontent related_places = "places" where { id: ('!'~ record.id) } limit 6 %}


     <section class="section main">
        <div class="container">
            <div class="columns">
                <div class="column">
                    <div class="columns is-multiline is-variable bd-klmn-columns is-1">
                        {% for related_place in related_places %}
                            {% include '_place.twig' with { 'place' : related_place } only %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
     </section>

{% endblock main %}

{% block bottom_js %}
    {{ parent() }}
    <script>
        $('.place-slider').slick({
            dots: true,
            adaptiveHeight: true,
        });
    </script>
{% endblock %}